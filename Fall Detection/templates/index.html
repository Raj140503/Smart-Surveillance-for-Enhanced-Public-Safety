<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fall Detection - Real-Time Safety Monitoring</title>
  <!-- Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
  <!-- SweetAlert2 for beautiful alerts -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    html {
      scroll-behavior: smooth;
    }
    body {
      font-family: 'Montserrat', sans-serif;
      background-color: #f8f9fa;
      color: #2c3e50;
    }
    .hero {
      background-image: linear-gradient(rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.7)), url('static/images/10778.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }
    .gradient-text {
      background: linear-gradient(90deg, #3498db, #2c3e50);
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .feature-card {
      transition: all 0.3s ease;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    .feature-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    }
    .btn-primary {
      background: linear-gradient(90deg, #3498db, #2980b9);
      transition: all 0.3s ease;
    }
    .btn-primary:hover {
      background: linear-gradient(90deg, #2980b9, #3498db);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
    }
    .btn-secondary {
      background: linear-gradient(90deg, #2ecc71, #27ae60);
      transition: all 0.3s ease;
    }
    .btn-secondary:hover {
      background: linear-gradient(90deg, #27ae60, #2ecc71);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
    }
    .section-heading::after {
      content: '';
      display: block;
      width: 100px;
      height: 3px;
      background: linear-gradient(90deg, #3498db, #2c3e50);
      margin: 15px auto 0;
    }
    .navbar {
      backdrop-filter: blur(10px);
      background-color: rgba(255, 255, 255, 0.8);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    .card-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      font-size: 24px;
      color: white;
    }
    /* Alert indicator styles */
    .alert-indicator {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      padding: 10px 20px;
      border-radius: 5px;
      display: none;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0% { background-color: rgba(231, 76, 60, 0.8); }
      50% { background-color: rgba(231, 76, 60, 1); }
      100% { background-color: rgba(231, 76, 60, 0.8); }
    }
  </style>
</head>
<body>
  <!-- Alert indicator -->
  <div id="alertIndicator" class="alert-indicator text-white font-bold">
    Fall Detected!
  </div>

  <!-- Hidden audio element for alarm sound -->
  <audio id="alarmSound" loop>
    <source src="static/sounds/alarm.mp3" type="audio/mpeg">
    <!-- Fallback for browsers that don't support MP3 -->
    <source src="static/sounds/alarm.wav" type="audio/wav">
    Your browser does not support the audio element.
  </audio>

  <!-- Navigation -->
  <nav class="navbar fixed w-full z-50 transition-all duration-300">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex-shrink-0 flex items-center">
          <a href="#home" class="text-2xl font-bold text-gray-800 animate__animated animate__fadeInLeft">
            <span class="gradient-text">Fall Detection</span>
          </a>
        </div>
        <div class="hidden md:flex items-center space-x-6">
          <a href="#home" class="px-3 py-2 font-medium text-gray-600 hover:text-blue-600 transition-colors">Home</a>
          <a href="#about" class="px-3 py-2 font-medium text-gray-600 hover:text-blue-600 transition-colors">About</a>
          <a href="#features" class="px-3 py-2 font-medium text-gray-600 hover:text-blue-600 transition-colors">Features</a>
          <a href="#implementation" class="px-3 py-2 font-medium text-gray-600 hover:text-blue-600 transition-colors">Implementation Details</a>
          <a href="#applications" class="px-3 py-2 font-medium text-gray-600 hover:text-blue-600 transition-colors">Applications</a>
          <a href="#contact" class="px-3 py-2 font-medium text-gray-600 hover:text-blue-600 transition-colors">Contact</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section id="home" class="hero h-screen flex items-center justify-center relative">
    <div class="text-center px-4">
      <h1 class="text-5xl md:text-7xl font-bold mb-4 animate__animated animate__fadeInDown text-gray-800">
        Real-Time <span class="gradient-text">Fall Detection</span>
      </h1>
      <p class="text-xl md:text-2xl mb-8 animate__animated animate__fadeInUp text-gray-600">
        Enhancing Safety through Advanced Monitoring
      </p>
      <a href="#features" class="btn-primary text-white px-8 py-3 rounded-full text-lg font-medium inline-block animate__animated animate__pulse animate__infinite">
        Explore Features
      </a>
    </div>
  </section>

  <!-- About Section -->
  <section id="about" class="py-20 bg-white">
    <div class="max-w-5xl mx-auto px-4">
      <h2 class="section-heading text-4xl font-bold text-center mb-10 animate__animated animate__fadeInDown text-gray-800">
        About Fall Detection
      </h2>
      <p class="text-xl text-center mb-12 animate__animated animate__fadeInUp text-gray-600">
        Fall Detection is a state-of-the-art fall detection system designed to protect vulnerable individuals by monitoring and detecting falls in real time. Whether in hospitals, care homes, or assisted living environments, our solution ensures rapid response and enhanced safety.
      </p>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div class="p-8 bg-white rounded-lg feature-card animate__animated animate__fadeInLeft">
          <div class="card-icon mx-auto" style="background: linear-gradient(45deg, #3498db, #2c3e50);">
            <i class="fas fa-question-circle"></i>
          </div>
          <h3 class="text-2xl font-semibold mb-4 text-center text-gray-800">Why Fall Detection?</h3>
          <p class="text-lg text-gray-600 text-center">
            Falls can have severe consequences, especially for the elderly and people with mobility issues. Our system detects falls instantly, allowing for prompt assistance and reducing the risk of further injury.
          </p>
        </div>
        <div class="p-8 bg-white rounded-lg feature-card animate__animated animate__fadeInRight">
          <div class="card-icon mx-auto" style="background: linear-gradient(45deg, #2ecc71, #27ae60);">
            <i class="fas fa-check-circle"></i>
          </div>
          <h3 class="text-2xl font-semibold mb-4 text-center text-gray-800">Key Benefits</h3>
          <ul class="text-lg text-gray-600 space-y-2 mx-auto w-fit">
            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Real-time monitoring</li>
            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Instant fall alerts</li>
            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Integration with emergency services</li>
            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Enhanced caregiver efficiency</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- features Section -->
  <section id="features" class="py-20 bg-white">
    <div class="max-w-4xl mx-auto px-4">
      <h2 class="section-heading text-4xl font-bold text-center mb-10 animate__animated animate__fadeInDown text-gray-800">
        Features
      </h2>
      <div class="flex justify-center mb-6">
        <button id="liveBtn" class="btn-secondary text-white px-6 py-2 rounded-lg mr-4 font-medium">
          Live Monitoring
        </button>
        <button id="videoBtn" class="btn-primary text-white px-6 py-2 rounded-lg font-medium">
          Video Analysis
        </button>
      </div>
      <!-- Video path input appears only when Video Analysis is clicked -->
      <div id="videoInputDiv" class="flex justify-center mb-6 hidden">
        <input type="text" id="videoPath" placeholder="Enter video file path" class="px-4 py-2 rounded-lg text-gray-800 mr-2 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
        <button id="startVideoBtn" class="btn-primary text-white px-4 py-2 rounded-lg font-medium">
          Start Analysis
        </button>
      </div>
      <div class="flex justify-center">
        <div class="w-full bg-white p-4 rounded-xl shadow-lg feature-card animate__animated animate__fadeInUp">
          <img id="stream" src="static/images/elderly_care.jpg" alt="Stream will appear here" class="w-full rounded-lg">
        </div>
      </div>
    </div>
  </section>

  <!-- Implementation Section -->
  <section id="implementation" class="py-20 bg-gray-100">
    <div class="max-w-5xl mx-auto px-4">
      <h2 class="section-heading text-4xl font-bold text-center mb-10 animate__animated animate__fadeInDown text-gray-800">
        Implementation Details
      </h2>
      <p class="text-xl text-center mb-12 animate__animated animate__fadeInUp text-gray-600">
        Fall Detection leverages cutting-edge machine learning and computer vision techniques to detect falls with high accuracy in various settings.
      </p>
      <div class="space-y-8">
        <div class="p-8 bg-white rounded-lg feature-card animate__animated animate__fadeInLeft">
          <div class="flex items-center">
            <div class="card-icon mr-6" style="background: linear-gradient(45deg, #3498db, #2c3e50);">
              <i class="fas fa-brain"></i>
            </div>
            <div>
              <h3 class="text-2xl font-semibold mb-2 text-gray-800">Deep Learning Models</h3>
              <p class="text-lg text-gray-600">
                Our system uses deep neural networks trained on diverse datasets to distinguish between normal activities and actual falls.
              </p>
            </div>
          </div>
        </div>
        <div class="p-8 bg-white rounded-lg feature-card animate__animated animate__fadeInRight">
          <div class="flex items-center">
            <div class="card-icon mr-6" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">
              <i class="fas fa-microchip"></i>
            </div>
            <div>
              <h3 class="text-2xl font-semibold mb-2 text-gray-800">Real-time video processing</h3>
              <p class="text-lg text-gray-600">
                Our system uses real-time video processing and alert mechanisms to detect falls and ensure user safety.
              </p>
            </div>
          </div>
        </div>
        <div class="p-8 bg-white rounded-lg feature-card animate__animated animate__fadeInLeft">
          <div class="flex items-center">
            <div class="card-icon mr-6" style="background: linear-gradient(45deg, #9b59b6, #8e44ad);">
              <i class="fas fa-bell"></i>
            </div>
            <div>
              <h3 class="text-2xl font-semibold mb-2 text-gray-800">Alert System</h3>
              <p class="text-lg text-gray-600">
                Once a fall is detected, our system sends real-time alerts to caregivers and emergency responders for immediate action.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Applications Section -->
  <section id="applications" class="py-20 bg-white">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="section-heading text-4xl font-bold text-center mb-10 animate__animated animate__fadeInDown text-gray-800">
        Applications
      </h2>
      <p class="text-xl text-center mb-12 animate__animated animate__fadeInUp text-gray-600">
        Fall Detection is ideal for a variety of environments where rapid fall detection can enhance safety and improve response times.
      </p>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
        <!-- Application 1: Elderly Care -->
        <div class="bg-white rounded-xl overflow-hidden feature-card animate__animated animate__zoomIn">
          <img src="static/images/1.jpg" alt="Elderly Care" class="w-full h-48 object-cover">
          <div class="p-6">
            <h3 class="text-2xl font-semibold mb-2 text-gray-800">Elderly Care</h3>
            <p class="text-lg text-gray-600">
              Monitor seniors in care homes or assisted living facilities to ensure immediate help in case of a fall.
            </p>
            <a href="#contact" class="inline-block mt-4 text-blue-600 hover:text-blue-800 font-medium">Learn more →</a>
          </div>
        </div>
        <!-- Application 2: Hospital Safety -->
        <div class="bg-white rounded-xl overflow-hidden feature-card animate__animated animate__zoomIn">
          <img src="static/images/hospital.avif" alt="Hospital Safety" class="w-full h-48 object-cover">
          <div class="p-6">
            <h3 class="text-2xl font-semibold mb-2 text-gray-800">Hospital Safety</h3>
            <p class="text-lg text-gray-600">
              Enhance patient monitoring in hospitals with real-time fall detection integrated into existing systems.
            </p>
            <a href="#contact" class="inline-block mt-4 text-blue-600 hover:text-blue-800 font-medium">Learn more →</a>
          </div>
        </div>
        <!-- Application 3: Workplace Monitoring -->
        <div class="bg-white rounded-xl overflow-hidden feature-card animate__animated animate__zoomIn">
          <img src="static/images/indus.avif" alt="Workplace Monitoring" class="w-full h-48 object-cover">
          <div class="p-6">
            <h3 class="text-2xl font-semibold mb-2 text-gray-800">Workplace Monitoring</h3>
            <p class="text-lg text-gray-600">
              Improve safety in industrial or construction sites by monitoring for falls and ensuring rapid response.
            </p>
            <a href="#contact" class="inline-block mt-4 text-blue-600 hover:text-blue-800 font-medium">Learn more →</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section id="contact" class="py-20 bg-gray-100">
    <div class="max-w-5xl mx-auto px-4">
      <h2 class="section-heading text-4xl font-bold text-center mb-10 animate__animated animate__fadeInDown text-gray-800">
        Get in Touch
      </h2>
      <p class="text-xl text-center mb-12 animate__animated animate__fadeInUp text-gray-600">
        Have questions or need more details about Fall Detection? Contact us today to learn how we can enhance safety in your facility.
      </p>
      <div class="max-w-md mx-auto bg-white p-8 rounded-xl shadow-lg">
        <form class="space-y-6">
          <div>
            <label for="name" class="block text-lg font-medium text-gray-700 mb-2">Your Name</label>
            <input type="text" id="name" class="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="John Smith">
          </div>
          <div>
            <label for="email" class="block text-lg font-medium text-gray-700 mb-2">Email Address</label>
            <input type="email" id="email" class="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="john@example.com">
          </div>
          <div>
            <label for="message" class="block text-lg font-medium text-gray-700 mb-2">Your Message</label>
            <textarea id="message" rows="4" class="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="How can we help you?"></textarea>
          </div>
          <div>
            <button type="submit" class="w-full btn-primary px-6 py-3 rounded-lg text-xl font-medium text-white">
              Send Message
            </button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-12 bg-gray-100">
    <div class="max-w-5xl mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center mb-8">
        <div class="mb-6 md:mb-0">
          <a href="#home" class="text-2xl font-bold text-gray-800">
            <span class="gradient-text">Fall Detection</span>
          </a>
          <p class="mt-2 text-gray-600">Advanced Fall Detection Solutions</p>
        </div>
        <div class="flex space-x-6">
          <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors">
            <i class="fab fa-twitter text-xl"></i>
          </a>
          <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors">
            <i class="fab fa-linkedin text-xl"></i>
          </a>
          <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors">
            <i class="fab fa-facebook text-xl"></i>
          </a>
          <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors">
            <i class="fab fa-instagram text-xl"></i>
          </a>
        </div>
      </div>
      <div class="border-t border-gray-200 pt-8 text-center">
        <p class="text-gray-600">&copy; 2025 Fall Detection. All Rights Reserved.</p>
      </div>
    </div>
  </footer>
  
  <!-- JavaScript -->
  <script>
// Get alert elements
const alarmSound = document.getElementById('alarmSound');
const alertIndicator = document.getElementById('alertIndicator');

// Dashboard controls
const liveBtn = document.getElementById('liveBtn');
const videoBtn = document.getElementById('videoBtn');
const startVideoBtn = document.getElementById('startVideoBtn');
const videoInputDiv = document.getElementById('videoInputDiv');
const streamImg = document.getElementById('stream');

// Variables to track monitoring state
let monitoringActive = false;
let statusCheckInterval = null;
let lastAlertTime = 0;
const alertCooldown = 20000; // 20 seconds cooldown in milliseconds
let fallDetectedTimeout = null;

// Function to start checking for falls
function startFallDetectionChecking() {
  if (statusCheckInterval) {
    clearInterval(statusCheckInterval);
  }
  
  monitoringActive = true;
  statusCheckInterval = setInterval(checkFallStatus, 2000); // Check every 2 seconds
}

// Function to stop checking for falls
function stopFallDetectionChecking() {
  monitoringActive = false;
  if (statusCheckInterval) {
    clearInterval(statusCheckInterval);
    statusCheckInterval = null;
  }
  
  // Clear any pending timeout
  if (fallDetectedTimeout) {
    clearTimeout(fallDetectedTimeout);
    fallDetectedTimeout = null;
  }
}

// Function to check if a fall was detected
function checkFallStatus() {
  if (!monitoringActive) return;
  
  fetch('/check_fall_status')
    .then(response => response.json())
    .then(data => {
      if (data.fall_detected) {
        const currentTime = Date.now();
        
        // Only schedule an alert if we're outside the cooldown period
        if (currentTime - lastAlertTime > alertCooldown) {
          // Schedule the alert to appear after 2 seconds
          if (!fallDetectedTimeout) {
            fallDetectedTimeout = setTimeout(() => {
              triggerFallAlert();
              fallDetectedTimeout = null;
              
              // Update the last alert time when alert is triggered
              lastAlertTime = Date.now();
            }, 2000);
          }
        }
      }
    })
    .catch(error => console.error('Error checking fall status:', error));
}

// Function to trigger fall alert
function triggerFallAlert() {
  // Show the alert
  Swal.fire({
    title: 'Fall Detected!',
    text: 'A fall has been detected. Emergency email has been sent.',
    icon: 'warning',
    confirmButtonText: 'Acknowledge',
    confirmButtonColor: '#3085d6',
    showClass: {
      popup: 'animate__animated animate__fadeInDown'
    },
    hideClass: {
      popup: 'animate__animated animate__fadeOutUp'
    }
  }).then((result) => {
    if (result.isConfirmed) {
      // Stop the alarm sound when the alert is acknowledged
      alarmSound.pause();
      alarmSound.currentTime = 0;
      
      // Hide the indicator
      alertIndicator.style.display = 'none';
    }
  });
  
  // Show the indicator
  alertIndicator.style.display = 'block';
  
  // Play alarm sound
  alarmSound.play().catch(e => {
    console.log('Error playing sound. User interaction required before audio can play.');
  });
}

// Start live monitoring when button is clicked
liveBtn.addEventListener('click', () => {
  videoInputDiv.classList.add('hidden');
  streamImg.src = '/live_feed';
  
  // Start checking for falls
  startFallDetectionChecking();
});

// Show video analysis input when button is clicked
videoBtn.addEventListener('click', () => {
  videoInputDiv.classList.remove('hidden');
  
  // Stop checking for falls until video analysis starts
  stopFallDetectionChecking();
});

// Start video analysis based on the provided file path
startVideoBtn.addEventListener('click', () => {
  const videoPath = document.getElementById('videoPath').value;
  if(videoPath) {
    streamImg.src = '/video_feed?video_path=' + encodeURIComponent(videoPath);
    
    // Start checking for falls
    startFallDetectionChecking();
  }
});

// Clean up on page unload
window.addEventListener('beforeunload', () => {
  stopFallDetectionChecking();
});
  </script>
</body>
</html>